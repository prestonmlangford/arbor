
#ifndef REVERSI_F1_H
#define REVERSI_F1_H
#include "reversi_bb.h"

/*
Q5
  ---------------------------------
7 | x |   |   |   |   |   |   | x |
  ---------------------------------
6 |   |   |   |   |   |   |   |   |
  ---------------------------------
5 |   |   |   |   |   |   |   |   |
  ---------------------------------
4 |   |   |   |   |   |   |   |   |
  ---------------------------------
3 |   |   |   |   |   |   |   |   |
  ---------------------------------
2 |   |   |   |   |   |   |   |   |
  ---------------------------------
1 |   |   |   |   |   |   |   |   |
  ---------------------------------
0 | x |   |   |   |   |   |   | x |
  ---------------------------------
    0   1   2   3   4   5   6   7
*/
#define Q5 (BB(0,0) | BB(0,7) | BB(7,0) | BB(7,7))

/*
Q4
  ---------------------------------
7 |   | x |   |   |   |   | x |   |
  ---------------------------------
6 | x |   |   |   |   |   |   | x |
  ---------------------------------
5 |   |   |   |   |   |   |   |   |
  ---------------------------------
4 |   |   |   |   |   |   |   |   |
  ---------------------------------
3 |   |   |   |   |   |   |   |   |
  ---------------------------------
2 |   |   |   |   |   |   |   |   |
  ---------------------------------
1 | x |   |   |   |   |   |   | x |
  ---------------------------------
0 |   | x |   |   |   |   | x |   |
  ---------------------------------
    0   1   2   3   4   5   6   7
*/
#define Q4 (BB(6,0) | BB(7,1) | BB(7,6) | BB(6,7) |\
            BB(1,0) | BB(0,1) | BB(0,6) | BB(1,7))

/*
Q3
  ---------------------------------
7 |   |   |   |   |   |   |   |   |
  ---------------------------------
6 |   | x |   |   |   |   | x |   |
  ---------------------------------
5 |   |   |   |   |   |   |   |   |
  ---------------------------------
4 |   |   |   |   |   |   |   |   |
  ---------------------------------
3 |   |   |   |   |   |   |   |   |
  ---------------------------------
2 |   |   |   |   |   |   |   |   |
  ---------------------------------
1 |   | x |   |   |   |   | x |   |
  ---------------------------------
0 |   |   |   |   |   |   |   |   |
  ---------------------------------
    0   1   2   3   4   5   6   7
*/
#define Q3 (BB(6,1) | BB(1,1) | BB(1,6) | BB(6,6))

/*
Q2
  ---------------------------------
7 |   |   | x | x | x | x |   |   |
  ---------------------------------
6 |   |   |   |   |   |   |   |   |
  ---------------------------------
5 | x |   |   |   |   |   |   | x |
  ---------------------------------
4 | x |   |   |   |   |   |   | x |
  ---------------------------------
3 | x |   |   |   |   |   |   | x |
  ---------------------------------
2 | x |   |   |   |   |   |   | x |
  ---------------------------------
1 |   |   |   |   |   |   |   |   |
  ---------------------------------
0 |   |   | x | x | x | x |   |   |
  ---------------------------------
    0   1   2   3   4   5   6   7
*/
#define Q2 (BB(7,2) | BB(7,3) | BB(7,4) | BB(7,5) |\
            BB(5,0) | BB(4,0) | BB(3,0) | BB(2,0) |\
            BB(5,7) | BB(4,7) | BB(3,7) | BB(2,7) |\
            BB(0,2) | BB(0,3) | BB(0,4) | BB(0,5))

/*
Q1
  ---------------------------------
7 |   |   |   |   |   |   |   |   |
  ---------------------------------
6 |   |   | x | x | x | x |   |   |
  ---------------------------------
5 |   | x |   |   |   |   | x |   |
  ---------------------------------
4 |   | x |   |   |   |   | x |   |
  ---------------------------------
3 |   | x |   |   |   |   | x |   |
  ---------------------------------
2 |   | x |   |   |   |   | x |   |
  ---------------------------------
1 |   |   | x | x | x | x |   |   |
  ---------------------------------
0 |   |   |   |   |   |   |   |   |
  ---------------------------------
    0   1   2   3   4   5   6   7
*/
#define Q1 (BB(6,2) | BB(6,3) | BB(6,4) | BB(6,5) |\
            BB(5,1) | BB(4,1) | BB(3,1) | BB(2,1) |\
            BB(5,2) | BB(4,2) | BB(3,2) | BB(2,2) |\
            BB(1,2) | BB(1,3) | BB(1,4) | BB(1,5))

/*
Q0
  ---------------------------------
7 |   |   |   |   |   |   |   |   |
  ---------------------------------
6 |   |   |   |   |   |   |   |   |
  ---------------------------------
5 |   |   | x |   |   | x |   |   |
  ---------------------------------
4 |   |   |   | x | x |   |   |   |
  ---------------------------------
3 |   |   |   | x | x |   |   |   |
  ---------------------------------
2 |   |   | x |   |   | x |   |   |
  ---------------------------------
1 |   |   |   |   |   |   |   |   |
  ---------------------------------
0 |   |   |   |   |   |   |   |   |
  ---------------------------------
    0   1   2   3   4   5   6   7
*/
#define Q0 (BB(5,2) | BB(5,5) | BB(2,2) | BB(2,5) |\
            BB(4,3) | BB(4,4) | BB(3,3) | BB(3,4))

#define F1_P(f,e)\
({\
    float _f = (float) bb_popcount(f);\
    float _e = (float) bb_popcount(e);\
    0.5*(1.0 + (_f - _e)/(_f + _e + __FLT_EPSILON__));\
})

#define FEATURE_SET_1(f,e)\
{\
    F1_P(f, e),\
    F1_P(bb_generate_moves(f, e), bb_generate_moves(e, f)),\
    F1_P(bb_mobility(f, e), bb_mobility(e, f)),\
    F1_P(f & Q5, e & Q5),\
    F1_P(f & Q4, e & Q4),\
    F1_P(f & Q3, e & Q3),\
    F1_P(f & Q2, e & Q2),\
    F1_P(f & Q1, e & Q1),\
    F1_P(f & Q0, e & Q0),\
}

#endif // REVERSI_F1_H
